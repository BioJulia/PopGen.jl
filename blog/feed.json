{
    "version": "https://jsonfeed.org/version/1",
    "title": "PopGen.jl Blog",
    "home_page_url": "https://BioJulia.net/PopGen.jl/blog",
    "description": "PopGen.jl Blog",
    "items": [
        {
            "id": "fst",
            "content_html": "<link rel=\"stylesheet\" href=\"/PopGen.jl/katex/katex.min.css\"><h1>A bit about FST</h1><p>If you have spent any time being exposed to population genetics, you've likely encountered the term  <em>FST</em>, our field's most beloved/maligned one-size-fits all coefficient. That description is a gross oversimplification, but the purpose of this post isn't to dig deep into the world of differentiation statistics, but instead shed light on the general concept and the logic behind its significance testing. </p><p>If you're like me, you've used and reported some kind of pairwise <strong>X</strong>ST statistic in your work, where that value was generated using some fantastic software like <a href=\"https://cran.r-project.org/web/packages/adegenet/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">adegenet</a> or <a href=\"https://www.bentleydrummer.nl/software/software/GenoDive.html\" target=\"_blank\" rel=\"noopener noreferrer\">GenoDive</a>, and you trusted that the methods were honest and appropriate (they are!). Part of the motivation behind PopGen.jl was to invest time into learning and understanding some of these methods I use, despite not coming from a mathematics or computer science background. Well, as I actually learn stuff and decode methods (no pun intended), I feel like it might be worthwhile to share some of my basic insights with others, in a way that I wish I could have been taught. So, this time it's <em>FST</em>. The purpose of this post is to cover the larger concepts without getting into the overwhelming math. Let's go!</p><h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"what-is-fst\">What is FST?<a class=\"hash-link\" href=\"#what-is-fst\" title=\"Direct link to heading\">â€‹</a></h2><p>To understand <em>FST</em>, we need to start with <em>F</em>, the inbreeding coefficient devised by brilliant-but-ethically-questionable Sewall Wright. The <em>F</em> coefficient was a mathematically simple way to understand the level of inbreeding in a group, originally described for cattle breeds (the ğŸ„ part isn't relevant, but it's a fun fact). There were three circumstantial versions of <em>F</em>, denoted by very straightforward subscripted letters: <em>FIT</em>, <em>FIS</em>, <em>FST</em>. The <strong>I</strong> stands for <strong>I</strong>ndividual, <strong>S</strong> for <strong>S</strong>ubpopulation, <strong>T</strong> for <strong>T</strong>otal. The combination of letters explains what relationship you are measuring:  <em>FIT</em> was the comparison of <em>F</em> for an Individual vs the Total, <em>FIS</em> was the comparison of <em>F</em> for an Individual vs a Subpopulation. </p><p>Logically, <em>FST</em> would then mean you were looking at <em>F</em> for Subpopulations vs the Total, which  is where population geneticists get all excited. The values range from 0 to 1, with 0 being panmixia (fully mixed) and 1 being complete isolation. Although it <em>seems</em> like it would be linear, it's not-- Wright considered 0.125 to be the cutoff between panmictic and divergent. If one was to calculate <em>FST</em> for one large group of individuals and get a value &gt;0.125, this would suggest there is population subdivision happening (exciting!!). </p><h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"pairwise-fst\">Pairwise FST<a class=\"hash-link\" href=\"#pairwise-fst\" title=\"Direct link to heading\">â€‹</a></h2><p>Going one step further, you can narrow how you calculate <em>FST</em> to identify different trends. A \"pairwise\" <em>FST</em> is when you calculate <em>FST</em> for only a pair of populations at a time. With a pairwise <em>FST</em>, you are now testing if two populations are panmictic or divergent with <em>each other</em>.  Depending on your study system and the questions you're trying to answer, this can be extremely valuable information. </p><p>From a genetic standpoint, it looks kinda like this:\n<img loading=\"lazy\" alt=\"fst_diagram\" src=\"/PopGen.jl/assets/images/FST-ada873bf402c073cbe3f6b386deb941a.png\" width=\"1761\" height=\"1401\"></p><p>This is an over-simplified system (diploid, single locus, biallelic, <strong>ignoring Hardy-Weinberg stuff</strong>), but it demonstrates the point. When you are investigating two groups, if they are both completely heterozygous for the locus (for the same alleles), you would assume the groups are fully mixed (<em>FST</em> = 0). And that makes sense, right? Given the information required to calculate <em>FST</em>, it's a reasonable conclusion to say those alleles are constantly shared between the groups. And the opposite then should be true too: if both groups are completely fixed for different alleles (<em>FST</em> = 1), then they clearly aren't sharing alleles with each other.</p><h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"pitfalls\">Pitfalls<a class=\"hash-link\" href=\"#pitfalls\" title=\"Direct link to heading\">â€‹</a></h2><p>Like I alluded to in the opening paragraph, <em>FST</em> (and it's derivatives) aren't a golden rule. There are natural phenomena that <em>FST</em> cannot account for, which may lead to misleading results or incorrect interpretations of results. For one, there are Hardy-Weinberg assumptions, so the presence of kin, overlapping generations, etc. kinda messes things up. Another is consideration is that the genetic data we collect now is only a snapshot in time.  If two populations are completely isolated from one another and have been for generations, but are long lived and slow to evolve, then <em>FST</em> may mislead you into believing they are panmictic (that happened in my <a href=\"https://link.springer.com/article/10.1007/s00227-019-3533-1\" target=\"_blank\" rel=\"noopener noreferrer\">shark study</a>). These are just a few examples and there are more.</p><h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"significance-testing\">Significance testing<a class=\"hash-link\" href=\"#significance-testing\" title=\"Direct link to heading\">â€‹</a></h2><p>One way of being more rigorous with <em>FST</em> values is significance testing (you know, generating those p-values everyone loves so much). So the question is, how do we do that? One common (frequentist) solution is permutation testing. The rationale is this: we get some kind of observed <em>FST</em> with our samples arranged in their natural populations, so would that  <em>FST</em> look the same if we shuffled the samples up? Honestly, that's the gist of it. We calculate our observed <em>FST</em> value, then we randomly shuffle the samples into two new populations and recalculate the pairwise <em>FST</em> for the new population pair. Then we just keep shuffling and recalculating <em>FST</em> a few thousands of times. After so many iterations, we compare how many times our observed (original) <em>FST</em> value was greater than the permuted <em>FST</em> values. This is known as a one-tailed test, since we're only interested in knowing if our observed <em>FST</em> is <em>greater</em> than randomness, meaning we're making the case that <em>FST</em> (and therefore divergence) is highest with our samples in this non-random population configuration. </p><h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"other-means\">Other means<a class=\"hash-link\" href=\"#other-means\" title=\"Direct link to heading\">â€‹</a></h2><p>The field of population genetics has expanded tremendously since the Fisher and Wright era, and there are now all sorts of interesting ways to identify population subdivision. Each method has its strengths and weaknesses, which is why it's good practice to try multiple things and find agreement between methods. At the time of this writing, PopGen.jl can calculate pairwise <em>FST</em> and perform significance testing using the <a href=\"https://books.google.com/books?hl=en&amp;lr=&amp;id=UhRSsLkjxDgC&amp;oi=fnd&amp;pg=PP11&amp;ots=Qu7vO8EMmw&amp;sig=T6cTISYEEm-hL8aWU8EgeGgzP5E#v=onepage&amp;q&amp;f=false\" target=\"_blank\" rel=\"noopener noreferrer\">Nei 1987</a>, <a href=\"https://www.jstor.org/stable/2408641?casa_token=_0gGbCbYpqMAAAAA:f9BvW9Xvx_8WaWSaRN4iqg0HB7KkaP21712ds28cTjhsvVQrYRTyHon7hKCcyHLcmTRA9H_1oM5iF3TZAl5xPm5gil2GmcGzHyEFFYAOl8pDVEBMQQ&amp;seq=1#metadata_info_tab_contents\" target=\"_blank\" rel=\"noopener noreferrer\">Weir &amp; Cockerham 1984</a>, and <a href=\"https://www.genetics.org/content/132/2/583\" target=\"_blank\" rel=\"noopener noreferrer\">Hudson et al. 1992</a> methods. If you're interested in <a href=\"https://biojulia.net/PopGen.jl/docs/gettingstarted/community\" target=\"_blank\" rel=\"noopener noreferrer\">contributing to PopGen.jl</a>, we'd love to have you!</p>",
            "url": "https://BioJulia.net/PopGen.jl/blog/fst",
            "title": "A bit about FST",
            "summary": "If you have spent any time being exposed to population genetics, you've likely encountered the term  FST, our field's most beloved/maligned one-size-fits all coefficient. That description is a gross oversimplification, but the purpose of this post isn't to dig deep into the world of differentiation statistics, but instead shed light on the general concept and the logic behind its significance testing.",
            "date_modified": "2021-04-04T00:00:00.000Z",
            "author": {
                "name": "Pavel Dimens",
                "url": "https://github.com/pdimens"
            },
            "tags": [
                "info"
            ]
        },
        {
            "id": "relatedness",
            "content_html": "<h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"getting-started\">Getting Started<a class=\"hash-link\" href=\"#getting-started\" title=\"Direct link to heading\">â€‹</a></h2><p>In a population genetics study, you often need to identify if there are kin in your data. This may be necessary because you are trying to remove kin from your data (because of Hardy-Weinberg assumptions), or maybe kinship is a central interest in your study. Either way, the goal of this tutorial is to provide you with a basic tutorial on using PopGen.jl to perform a relatedness analysis, which is sometimes called a <em>kinship</em> analysis. To follow along, you'll need to have Julia, along with the packages PopGen.jl, PopGenSims.jl, and StatsBase.jl installed. We'll be using the <code>nancycats</code> data because it's smaller than <code>gulfsharks</code>, so things should be a lot quicker.</p><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">using</span><span class=\"token plain\"> PopGen</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> PopGenSims</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> StatsBase</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> cats </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> @nancycats</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">PopData Object</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Markers</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> Microsatellite</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Ploidy</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">2</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Samples</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">237</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Loci</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Populations</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">17</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Coordinates</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> absent</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div><h3 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"estimators\">Estimators<a class=\"hash-link\" href=\"#estimators\" title=\"Direct link to heading\">â€‹</a></h3><p>Like <code>Coancestry</code> and the R packages that wrap it (i.e. <code>relate</code>, <code>related</code>), PopGen.jl provides a whole bunch of relatedness estimators that you can choose from for your data. Unfortunately, there is no right answer and you will need to use your discretion. Some people choose an estimator based on the heterozygosity of the data, others choose one based on more liberal or conservative values, and there are yet more criteria one can consider for choosing an estimator. To keep things simple, we're going to use <code>LynchLi</code>. Why? Because I'm the one writing this tutorial, and I said so ğŸ˜. </p><h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"the-steps\">The Steps<a class=\"hash-link\" href=\"#the-steps\" title=\"Direct link to heading\">â€‹</a></h2><h3 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"1-calculate-pairwise-relatedness\">1. Calculate pairwise relatedness<a class=\"hash-link\" href=\"#1-calculate-pairwise-relatedness\" title=\"Direct link to heading\">â€‹</a></h3><p>This seems pretty obvious, but it needs to be said. In order to do the analysis, you need you get the pairwise relatedness values for the individuals of interest in your data. To keep things simple, we're going to do an all-by-all comparison. But, we also want to boostrap the pairs to create confidence intervals (\"CI\") for each pair, so let's talk about that.</p><h3 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"2-bootstrap-to-calculate-ci\">2. Bootstrap to calculate CI<a class=\"hash-link\" href=\"#2-bootstrap-to-calculate-ci\" title=\"Direct link to heading\">â€‹</a></h3><p>It would behoove us to bootstrap the loci in a pairwise comparison <em>n</em> number of times so we can create a confidence interval for the relatedness estimates for each pair. This inflates the runtime of the analysis substantially, but it's a very useful method in making sense of our estimates. If one was to be conservative (and we generally are), then we would reject an estimate for a pair whose CI includes zero. In PopGen.jl, the estimates and bootstrapping are done all at once to minimize processing time, so the command for that would be</p><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> rel_out  </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> relatedness</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">cats</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> method </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> iterations </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1000</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div><p>By default, the <code>relatedness</code> function uses a 95% CI (<code>interval = (0.025, 0.975)</code>), but you can change that with <code>interval = (low,high)</code> where <code>low</code> and <code>high</code> are decimals of your quantiles.\nThe <code>relatedness()</code> function returns a <code>NamedTuple</code> of dataframes whenever you are bootstrapping, where each element shares its name with the method used, so in this case, we can access our results with <code>rel_out.LynchLi</code>.</p><div class=\"tabs-container\"><ul role=\"tablist\" aria-orientation=\"horizontal\" class=\"tabs tabs--block\"><li role=\"tab\" tabindex=\"0\" aria-selected=\"true\" class=\"tabs__item tabItem_LplD tabs__item--active\">relatedness</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LplD\">plotting</li></ul><div class=\"margin-vert--md\"><div role=\"tabpanel\"><div class=\"codeBlockContainer_I0IT theme-code-block\"><div class=\"codeBlockContent_wNvx\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia&gt; rel_out.LynchLi</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">27966Ã—8 DataFrame</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   Row â”‚ sample_1  sample_2  n_loci  LynchLi     LynchLi_mean  LynchLi_median  LynchLi_S â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">       â”‚ String    String    Int64   Float64?    Float64?      Float64?        Float64?  â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     1 â”‚ N215      N216           8   0.743535      0.747288        0.748042     0.75344 â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     2 â”‚ N215      N217           8   0.230605      0.233593        0.240085     0.34187</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     3 â”‚ N215      N218           8   0.230605      0.230507        0.221861     0.32161</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     4 â”‚ N215      N219           8   0.230605      0.23601         0.23567      0.32782</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     5 â”‚ N215      N220           8   0.333191      0.33798         0.350492     0.39898 â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     6 â”‚ N215      N221           8   0.589656      0.594223        0.601308     0.61945</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     7 â”‚ N215      N222           8   0.0254328     0.0347216       0.0262021    0.21408</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     8 â”‚ N215      N223           8   0.333191      0.329983        0.331411     0.38402</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     9 â”‚ N215      N224           8  -0.0258602    -0.021062       -0.0301579    0.21112 â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    10 â”‚ N215      N7             8  -0.282325     -0.27967        -0.288337     0.33611</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    11 â”‚ N215      N141           8  -0.0771532    -0.0796867      -0.083113     0.21261</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    12 â”‚ N215      N142           8   0.0254328     0.0302549       0.0330718    0.23957</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   â‹®   â”‚    â‹®         â‹®        â‹®         â‹®            â‹®              â‹®             â‹®     â‹±</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27955 â”‚ N295      N289           7   0.322731      0.347021        0.34118      0.41168 â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27956 â”‚ N295      N290           7   0.153414      0.160102        0.164866     0.22862</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27957 â”‚ N296      N297           7  -0.0159038    -0.0182747      -0.0187108    0.16981</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27958 â”‚ N296      N281           7   0.0405353     0.037025        0.0422647    0.15294</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27959 â”‚ N296      N289           7   0.322731      0.328379        0.337317     0.35578 â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27960 â”‚ N296      N290           7   0.153414      0.152384        0.16194      0.19131</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27961 â”‚ N297      N281           7  -0.0159038    -0.0128349      -0.0303449    0.21030</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27962 â”‚ N297      N289           7   0.37917       0.392517        0.392818     0.45139</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27963 â”‚ N297      N290           7   0.435609      0.437829        0.450044     0.47027 â‹¯</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27964 â”‚ N281      N289           8   0.20428       0.21279         0.207425     0.29611</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27965 â”‚ N281      N290           7   0.37917       0.386583        0.390585     0.45471</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 27966 â”‚ N289      N290           7   0.209853      0.217811        0.222894     0.28649</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">                                                          2 columns and 27942 rows omitted</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div><div role=\"tabpanel\" hidden=\"\"><p>And while it's totally optional, we can plot the distribution of values for some visual data exploration. For that we'll use Plots.jl and StatsPlots.jl. </p><div class=\"admonition admonition-note alert alert--secondary\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>plotting packages</h5></div><div class=\"admonition-content\"><p>We could have used any plotting package, but Plots.jl was chosen for simplicity. Other great\noptions are (and not limited to): Makie.jl, Gadfly.jl, VegaLite.jl, and PlotlyJS.jl.</p></div></div><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">using</span><span class=\"token plain\"> Plots</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> StatsPlots</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> density</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">rel_out</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> title</span><span class=\"token operator\" style=\"color:#393A34\">!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token string\" style=\"color:#e3116c\">\"LynchLi relatedness\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div><p><img loading=\"lazy\" alt=\"relatedness_histo\" src=\"/PopGen.jl/assets/images/nancycats_LynchLi-8b8fb132d841ad2cdff25f8b4d25c16d.png\" width=\"600\" height=\"400\"></p></div></div></div><h3 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"3-create-cis-for-the-sibships\">3. Create CI's for the sibships<a class=\"hash-link\" href=\"#3-create-cis-for-the-sibships\" title=\"Direct link to heading\">â€‹</a></h3><div class=\"admonition admonition-note alert alert--secondary\"><div class=\"admonition-heading\"><h5><span class=\"admonition-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"14\" height=\"16\" viewBox=\"0 0 14 16\"><path fill-rule=\"evenodd\" d=\"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z\"></path></svg></span>There's more???</h5></div><div class=\"admonition-content\"><p>The next set of steps seem like a lot more work, so allow me to explain. The estimators all generally give you some value between 0-1 (or 0-0.5, same idea) and you can intuit that certain values mean certain things, like that <code>0</code> is \"unrelated\", <code>0.25</code> is \"half-sib\", and <code>0.5</code> is \"full-sib\". However, those are fixed values, so how do we know how far we can deviate from 0.25 (for example) and still call our pair half-siblings? Instead of hand-waving, we can create confidence intervals from simulated data to act as sibship ranges for our data. If this doesn't make sense yet, it will below. Promise! </p></div></div><h4 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"i-simulate-known-sibship-pairs\">i. simulate known sibship pairs<a class=\"hash-link\" href=\"#i-simulate-known-sibship-pairs\" title=\"Direct link to heading\">â€‹</a></h4><p>Next, we need to further contextualize what out estimates actually mean, and we need to devise a rigorous and defensible method to define the sibling-ship (\"sibship\") of a pair of samples as <strong>unrelated</strong>, <strong>half-sibs</strong>, or <strong>full-sibs</strong>. To do this, we're going to use PopGenSims.jl to simulate data based on the allele frequencies in our data. What <code>simulate_sibship</code> does is simulate individuals based on the allele frequencies in your <code>PopData</code>, then simulate offspring of a particular siblingship resulting from the \"mating\" of those individuals. For example, when you specify <code>\"fullsib\"</code>, it generates two offspring resulting from two parents, <code>n</code> number of times. We want to do this for each of the three kinds of sibships.</p><div class=\"tabs-container\"><ul role=\"tablist\" aria-orientation=\"horizontal\" class=\"tabs tabs--block\"><li role=\"tab\" tabindex=\"0\" aria-selected=\"true\" class=\"tabs__item tabItem_LplD tabs__item--active\">simulate unrelated</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LplD\">simulate halfsib</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LplD\">simulate fullsib</li></ul><div class=\"margin-vert--md\"><div role=\"tabpanel\"><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> unrelated_sims </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> simulate_sibship</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">cats</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> n </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> relationship</span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"unrelated\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">PopData Object</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Markers</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> Microsatellite</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Ploidy</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">2</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Samples</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1000</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Loci</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Populations</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Coordinates</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> absent</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div><div role=\"tabpanel\" hidden=\"\"><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> halfsib_sims </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> simulate_sibship</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">cats</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> n </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> relationship</span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"halfsib\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">PopData Object</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Markers</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> Microsatellite</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Ploidy</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">2</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Samples</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1000</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Loci</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Populations</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Coordinates</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> absent</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div><div role=\"tabpanel\" hidden=\"\"><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> fullsib_sims </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> simulate_sibship</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">cats</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> n </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> relationship</span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"fullsib\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">PopData Object</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Markers</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> Microsatellite</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Ploidy</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">2</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Samples</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1000</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Loci</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Populations</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Coordinates</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\"> absent</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div></div></div><p>Technically, we could merge all three results into a single <code>PopData</code>, but it will be easier to explain things if we don't. Feel free to take a peep into the simulated data:</p><div class=\"tabs-container\"><ul role=\"tablist\" aria-orientation=\"horizontal\" class=\"tabs tabs--block\"><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LplD\">meta</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LplD\">loci</li></ul><div class=\"margin-vert--md\"><div role=\"tabpanel\" hidden=\"\"><div class=\"codeBlockContainer_I0IT theme-code-block\"><div class=\"codeBlockContent_wNvx\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia&gt; unrelated_sims.sampleinfo</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">1000Ã—5 DataFrame</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Row â”‚ name            population  ploidy  longitude  latitude </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      â”‚ String          String      Int64   Float32?   Float32? </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    1 â”‚ sim1_un_off1    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    2 â”‚ sim1_un_off2    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    3 â”‚ sim2_un_off1    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    4 â”‚ sim2_un_off2    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    5 â”‚ sim3_un_off1    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    6 â”‚ sim3_un_off2    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    7 â”‚ sim4_un_off1    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    8 â”‚ sim4_un_off2    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    9 â”‚ sim5_un_off1    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   10 â”‚ sim5_un_off2    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   11 â”‚ sim6_un_off1    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   12 â”‚ sim6_un_off2    unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  â‹®   â”‚       â‹®             â‹®         â‹®         â‹®         â‹®</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  989 â”‚ sim495_un_off1  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  990 â”‚ sim495_un_off2  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  991 â”‚ sim496_un_off1  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  992 â”‚ sim496_un_off2  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  993 â”‚ sim497_un_off1  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  994 â”‚ sim497_un_off2  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  995 â”‚ sim498_un_off1  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  996 â”‚ sim498_un_off2  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  997 â”‚ sim499_un_off1  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  998 â”‚ sim499_un_off2  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  999 â”‚ sim500_un_off1  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 1000 â”‚ sim500_un_off2  unrelated        2   missing   missing  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">                                                976 rows omitted</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div><div role=\"tabpanel\" hidden=\"\"><div class=\"codeBlockContainer_I0IT theme-code-block\"><div class=\"codeBlockContent_wNvx\"><pre tabindex=\"0\" class=\"prism-code language-text codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia&gt; unrelated_sims.genodata</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">9000Ã—4 DataFrame</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  Row â”‚ name            population  locus   genotype   </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">      â”‚ String          String      String  Tupleâ€¦     </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    1 â”‚ sim1_un_off1    unrelated   fca8    (135, 141)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    2 â”‚ sim1_un_off1    unrelated   fca23   (132, 132)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    3 â”‚ sim1_un_off1    unrelated   fca43   (143, 139)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    4 â”‚ sim1_un_off1    unrelated   fca45   (126, 116)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    5 â”‚ sim1_un_off1    unrelated   fca77   (154, 148)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    6 â”‚ sim1_un_off1    unrelated   fca78   (150, 142)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    7 â”‚ sim1_un_off1    unrelated   fca90   (199, 193)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    8 â”‚ sim1_un_off1    unrelated   fca96   (109, 91)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    9 â”‚ sim1_un_off1    unrelated   fca37   (208, 210)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   10 â”‚ sim1_un_off2    unrelated   fca8    (139, 123)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   11 â”‚ sim1_un_off2    unrelated   fca23   (140, 130)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   12 â”‚ sim1_un_off2    unrelated   fca43   (139, 141)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  â‹®   â”‚       â‹®             â‹®         â‹®         â‹®</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8989 â”‚ sim500_un_off1  unrelated   fca90   (199, 197)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8990 â”‚ sim500_un_off1  unrelated   fca96   (105, 113)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8991 â”‚ sim500_un_off1  unrelated   fca37   (208, 208)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8992 â”‚ sim500_un_off2  unrelated   fca8    (135, 137)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8993 â”‚ sim500_un_off2  unrelated   fca23   (136, 130)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8994 â”‚ sim500_un_off2  unrelated   fca43   (139, 145)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8995 â”‚ sim500_un_off2  unrelated   fca45   (120, 120)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8996 â”‚ sim500_un_off2  unrelated   fca77   (150, 156)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8997 â”‚ sim500_un_off2  unrelated   fca78   (142, 152)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8998 â”‚ sim500_un_off2  unrelated   fca90   (189, 191)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 8999 â”‚ sim500_un_off2  unrelated   fca96   (113, 113)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> 9000 â”‚ sim500_un_off2  unrelated   fca37   (208, 182)</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">                                      8976 rows omitted</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div></div></div><h4 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"ii-get-relatedness-estimates-for-the-simulated-data\">ii. get relatedness estimates for the simulated data<a class=\"hash-link\" href=\"#ii-get-relatedness-estimates-for-the-simulated-data\" title=\"Direct link to heading\">â€‹</a></h4><p>Next, we want to get the relatedness estimate for each simulated pair of \"known\" sibship. We are only interested in the values for the simulated pairs and not samples across pairs. If you aren't sure why that is, think of it this way: we're trying to create a range of values where we can confidently say unknown things are full-sibs (or half-sib, etc.), so we want to know what range of values we get from a bunch of known fullsib pairs, not the unknown relationships of samples between pairs. </p><p>It would a nightmare to manually specify only 2 individuals at a time into <code>relatedness()</code>. Instead, the function has a shortcut built into it that will recognize the <code>population</code> names generated from <code>simulate_sibship</code> and only give you relatedness estimates for those pairs. So, we just need to run it once for each of our simulations, this time <em>without</em> bootstrapping because we are only interested in the estimates. Make sure to use the same estimator! The run will be a lot faster this time because it only needs to calculate estimates for 500 pairs each time (our <code>n</code> from above) and without bootstrapping. When not bootstrapping, <code>relatedness()</code> returns a dataframe (versus a NamedTuple of dataframes).</p><div class=\"tabs-container\"><ul role=\"tablist\" aria-orientation=\"horizontal\" class=\"tabs tabs--block\"><li role=\"tab\" tabindex=\"0\" aria-selected=\"true\" class=\"tabs__item tabItem_LplD tabs__item--active\">unrelated relatedness</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LplD\">halfsib relatedness</li><li role=\"tab\" tabindex=\"-1\" aria-selected=\"false\" class=\"tabs__item tabItem_LplD\">fullsib relatedness</li></ul><div class=\"margin-vert--md\"><div role=\"tabpanel\"><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> un_sims_rel </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> relatedness</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">unrelated_sims</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> method </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token plain\">Ã—</span><span class=\"token number\" style=\"color:#36acaa\">4</span><span class=\"token plain\"> DataFrame</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> Row â”‚ sample_1        sample_2        n_loci  LynchLi    </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     â”‚ String          String          Int64   Float64</span><span class=\"token punctuation\" style=\"color:#393A34\">?</span><span class=\"token plain\">   </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token plain\"> â”‚ sim100_un_off1  sim100_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.0187624</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">2</span><span class=\"token plain\"> â”‚ sim101_un_off1  sim101_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.204246</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">3</span><span class=\"token plain\"> â”‚ sim102_un_off1  sim102_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.0633641</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">4</span><span class=\"token plain\"> â”‚ sim103_un_off1  sim103_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.241771</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">5</span><span class=\"token plain\"> â”‚ sim104_un_off1  sim104_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.338051</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">6</span><span class=\"token plain\"> â”‚ sim105_un_off1  sim105_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.0187624</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">7</span><span class=\"token plain\"> â”‚ sim106_un_off1  sim106_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.29345</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">8</span><span class=\"token plain\"> â”‚ sim107_un_off1  sim107_un_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.0633641</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  â‹®  â”‚       â‹®               â‹®           â‹®         â‹®</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">494</span><span class=\"token plain\"> â”‚ sim94_un_off1   sim94_un_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.159644</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">495</span><span class=\"token plain\"> â”‚ sim95_un_off1   sim95_un_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.0704411</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">496</span><span class=\"token plain\"> â”‚ sim96_un_off1   sim96_un_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.0633641</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">497</span><span class=\"token plain\"> â”‚ sim97_un_off1   sim97_un_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.241771</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">498</span><span class=\"token plain\"> â”‚ sim98_un_off1   sim98_un_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.0704411</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">499</span><span class=\"token plain\"> â”‚ sim99_un_off1   sim99_un_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.241771</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token plain\"> â”‚ sim9_un_off1    sim9_un_off2         </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.197169</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">                                          </span><span class=\"token number\" style=\"color:#36acaa\">485</span><span class=\"token plain\"> rows omitted</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div><div role=\"tabpanel\" hidden=\"\"><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> half_sims_rel </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> relatedness</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">halfsib_sims</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> method </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token plain\">Ã—</span><span class=\"token number\" style=\"color:#36acaa\">4</span><span class=\"token plain\"> DataFrame</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> Row â”‚ sample_1        sample_2        n_loci  LynchLi    </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     â”‚ String          String          Int64   Float64</span><span class=\"token punctuation\" style=\"color:#393A34\">?</span><span class=\"token plain\">   </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token plain\"> â”‚ sim100_hs_off1  sim100_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.111231</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">2</span><span class=\"token plain\"> â”‚ sim101_hs_off1  sim101_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.111231</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">3</span><span class=\"token plain\"> â”‚ sim102_hs_off1  sim102_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.333423</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">4</span><span class=\"token plain\"> â”‚ sim103_hs_off1  sim103_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.0220842</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">5</span><span class=\"token plain\"> â”‚ sim104_hs_off1  sim104_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.111231</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">6</span><span class=\"token plain\"> â”‚ sim105_hs_off1  sim105_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.244546</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">7</span><span class=\"token plain\"> â”‚ sim106_hs_off1  sim106_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.244546</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">8</span><span class=\"token plain\"> â”‚ sim107_hs_off1  sim107_hs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.377862</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  â‹®  â”‚       â‹®               â‹®           â‹®         â‹®</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">494</span><span class=\"token plain\"> â”‚ sim94_hs_off1   sim94_hs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.200108</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">495</span><span class=\"token plain\"> â”‚ sim95_hs_off1   sim95_hs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.244546</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">496</span><span class=\"token plain\"> â”‚ sim96_hs_off1   sim96_hs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.0223543</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">497</span><span class=\"token plain\"> â”‚ sim97_hs_off1   sim97_hs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.200108</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">498</span><span class=\"token plain\"> â”‚ sim98_hs_off1   sim98_hs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.111231</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">499</span><span class=\"token plain\"> â”‚ sim99_hs_off1   sim99_hs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.333423</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token plain\"> â”‚ sim9_hs_off1    sim9_hs_off2         </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">0.288985</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">                                          </span><span class=\"token number\" style=\"color:#36acaa\">485</span><span class=\"token plain\"> rows omitted</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div><div role=\"tabpanel\" hidden=\"\"><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> full_sims_rel </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> relatedness</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">fullsib_sims</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> method </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token plain\">Ã—</span><span class=\"token number\" style=\"color:#36acaa\">4</span><span class=\"token plain\"> DataFrame</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> Row â”‚ sample_1        sample_2        n_loci  LynchLi   </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">     â”‚ String          String          Int64   Float64</span><span class=\"token punctuation\" style=\"color:#393A34\">?</span><span class=\"token plain\">  </span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token plain\"> â”‚ sim100_fs_off1  sim100_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.510483</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">2</span><span class=\"token plain\"> â”‚ sim101_fs_off1  sim101_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.465982</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">3</span><span class=\"token plain\"> â”‚ sim102_fs_off1  sim102_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.42148</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">4</span><span class=\"token plain\"> â”‚ sim103_fs_off1  sim103_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.376979</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">5</span><span class=\"token plain\"> â”‚ sim104_fs_off1  sim104_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.465982</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">6</span><span class=\"token plain\"> â”‚ sim105_fs_off1  sim105_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.688489</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">7</span><span class=\"token plain\"> â”‚ sim106_fs_off1  sim106_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.287976</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">   </span><span class=\"token number\" style=\"color:#36acaa\">8</span><span class=\"token plain\"> â”‚ sim107_fs_off1  sim107_fs_off2       </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.599486</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">  â‹®  â”‚       â‹®               â‹®           â‹®         â‹®</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">494</span><span class=\"token plain\"> â”‚ sim94_fs_off1   sim94_fs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.688489</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">495</span><span class=\"token plain\"> â”‚ sim95_fs_off1   sim95_fs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.821994</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">496</span><span class=\"token plain\"> â”‚ sim96_fs_off1   sim96_fs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.554985</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">497</span><span class=\"token plain\"> â”‚ sim97_fs_off1   sim97_fs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.599486</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">498</span><span class=\"token plain\"> â”‚ sim98_fs_off1   sim98_fs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.554985</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">499</span><span class=\"token plain\"> â”‚ sim99_fs_off1   sim99_fs_off2        </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.510483</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">500</span><span class=\"token plain\"> â”‚ sim9_fs_off1    sim9_fs_off2         </span><span class=\"token number\" style=\"color:#36acaa\">9</span><span class=\"token plain\">  </span><span class=\"token number\" style=\"color:#36acaa\">0.376979</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">                                         </span><span class=\"token number\" style=\"color:#36acaa\">485</span><span class=\"token plain\"> rows omitted</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></div></div></div><p>And if we wanted to plot out what that looks like (optional):</p><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">using</span><span class=\"token plain\"> Plots</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> StatsPlots</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> density</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">rel_out</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> label </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"real data\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> color </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\">grey</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> fill </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\">grey</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> density</span><span class=\"token operator\" style=\"color:#393A34\">!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">un_sims_rel</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> label </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"unrelated\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> density</span><span class=\"token operator\" style=\"color:#393A34\">!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">half_sims_rel</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> label </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"halfsib\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> color </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\">blue</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> density</span><span class=\"token operator\" style=\"color:#393A34\">!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">full_sims_rel</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> label </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token string\" style=\"color:#e3116c\">\"fullsib\"</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> color </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token plain\">black</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> title</span><span class=\"token operator\" style=\"color:#393A34\">!</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token string\" style=\"color:#e3116c\">\"relatedness estimates on simulated and real data\"</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div><p><img loading=\"lazy\" alt=\"relatedness_histo\" src=\"/PopGen.jl/assets/images/nancycats_sims-d891d2c0c1dcf2f3fb45784ca0664959.png\" width=\"600\" height=\"400\"></p><p>Hopefully by now you are starting to contextualize why we're doing all of this. The distributions generated from our simulated data are giving us a better indication of what \"unrelated\", \"halfsib\", and \"fullsib\" estimates look like in our data.</p><h4 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"iii-sibship-intervals\">iii. sibship intervals<a class=\"hash-link\" href=\"#iii-sibship-intervals\" title=\"Direct link to heading\">â€‹</a></h4><p>What we just did is create null distributions for each sibship relationship, so now all that's left is to get a confidence interval from each.</p><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> unrelated_ci </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> quantile</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">un_sims_rel</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0.025</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0.975</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.3380513384854698</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0.33097433075726507</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> halfsibs_ci </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> quantile</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">half_sims_rel</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0.025</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0.975</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token operator\" style=\"color:#393A34\">-</span><span class=\"token number\" style=\"color:#36acaa\">0.06652262584414452</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0.5556155725649398</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\" style=\"display:inline-block\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">julia</span><span class=\"token operator\" style=\"color:#393A34\">&gt;</span><span class=\"token plain\"> fullsibs_ci </span><span class=\"token operator\" style=\"color:#393A34\">=</span><span class=\"token plain\"> quantile</span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token plain\">full_sims_rel</span><span class=\"token punctuation\" style=\"color:#393A34\">.</span><span class=\"token plain\">LynchLi</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0.025</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0.975</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token punctuation\" style=\"color:#393A34\">(</span><span class=\"token number\" style=\"color:#36acaa\">0.1989727186688347</span><span class=\"token punctuation\" style=\"color:#393A34\">,</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">0.8219939374819633</span><span class=\"token punctuation\" style=\"color:#393A34\">)</span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div><p>So, given our data and the simulations we made, we can now make a reasonable assumption regarding the ranges for each sibship relationship:</p><table><thead><tr><th align=\"left\">Relationship</th><th align=\"center\">Lower Bound</th><th align=\"center\">Upper Bound</th></tr></thead><tbody><tr><td align=\"left\">unrelated</td><td align=\"center\">-0.338</td><td align=\"center\">0.331</td></tr><tr><td align=\"left\">half sibling</td><td align=\"center\">-0.066</td><td align=\"center\">0.555</td></tr><tr><td align=\"left\">full sibling</td><td align=\"center\">0.199</td><td align=\"center\">0.82</td></tr></tbody></table><h3 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"4-finally-the-data-assessment\">4. Finally, the data assessment<a class=\"hash-link\" href=\"#4-finally-the-data-assessment\" title=\"Direct link to heading\">â€‹</a></h3><p>Now that we have our relatedness estimates and the acceptable sibship ranges given our data, we can see where our data falls.\n<em>Now</em>, we can say that a particular sample pair is unrelated/halfsib/fullsib if:</p><ol><li>that pair's confidence interval does not include zero and </li><li>that pair's estimate falls within any of the three calculate ranges</li></ol><p>Unfortunately, the ranges overlap quite a bit, which makes interpretation difficult, so it may be suitable to use a different estimator. </p><h3 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"closing-remarks\">Closing remarks<a class=\"hash-link\" href=\"#closing-remarks\" title=\"Direct link to heading\">â€‹</a></h3><p>There is more that can be done for relatedness, like network analysis. However, this tutorial covers what we consider a reasonable way to assess kinship in population genetic studies. If removing kin is your ultimate goal, consider the effects doing that may have on the analyses you are looking to do. Additionally, consider which individual of a pair you would remove and why. If you were curious as to how many identical loci a pair of samples may share, you can check that using <code>pairwiseidentical()</code>. Good luck!</p>",
            "url": "https://BioJulia.net/PopGen.jl/blog/relatedness",
            "title": "Relatedness Tutorial",
            "summary": "Getting Started",
            "date_modified": "2020-11-14T00:00:00.000Z",
            "author": {
                "name": "Pavel Dimens",
                "url": "https://github.com/pdimens"
            },
            "tags": [
                "tutorials"
            ]
        },
        {
            "id": "logos",
            "content_html": "<h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"what-is-that-logo\">What is that logo?<a class=\"hash-link\" href=\"#what-is-that-logo\" title=\"Direct link to heading\">â€‹</a></h2><p>If you haven't guessed already, it's the beloved Punnett Square! Nothing screams genetics like everyone's first entry-level genetic diagram!</p><h2 class=\"anchor anchorWithHideOnScrollNavbar_R0VQ\" id=\"the-logo-graveyard\">The Logo Graveyard<a class=\"hash-link\" href=\"#the-logo-graveyard\" title=\"Direct link to heading\">â€‹</a></h2><p>While this is completely unrelated to anything important about population genetics or Julia, I (Pavel) want you all to understand the logo-development process that led us to our logo so you can <em>feel</em> my struggle. The process is as follows:</p><ol><li><p>Jason and I spitball ideas</p></li><li><p>I procrastinate real work and open up Inkscape to draft some ideas</p></li><li><p>I compose 1-3 versions of an idea and send it to Jason</p></li><li><div class=\"codeBlockContainer_I0IT language-julia theme-code-block\"><div class=\"codeBlockContent_wNvx julia\"><pre tabindex=\"0\" class=\"prism-code language-julia codeBlock_jd64 thin-scrollbar\" style=\"color:#393A34;background-color:#f6f8fa\"><code class=\"codeBlockLines_mRuA\"><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token keyword\" style=\"color:#00009f\">if</span><span class=\"token plain\"> Jason </span><span class=\"token operator\" style=\"color:#393A34\">!=</span><span class=\"token plain\"> veto</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">for</span><span class=\"token plain\"> i </span><span class=\"token keyword\" style=\"color:#00009f\">in</span><span class=\"token plain\"> </span><span class=\"token number\" style=\"color:#36acaa\">1</span><span class=\"token punctuation\" style=\"color:#393A34\">:</span><span class=\"token number\" style=\"color:#36acaa\">5</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    Jason critiques and suggests changes</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">        I makes the changes</span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\">    </span><span class=\"token keyword\" style=\"color:#00009f\">end</span><span class=\"token plain\"></span><br></span><span class=\"token-line\" style=\"color:#393A34\"><span class=\"token plain\"></span><span class=\"token keyword\" style=\"color:#00009f\">end</span><span class=\"token plain\"> </span><br></span></code></pre><button type=\"button\" aria-label=\"Copy code to clipboard\" class=\"copyButton_wuS7 clean-btn\">Copy</button></div></div></li><li><p>Jason and I finalize the idea!</p></li><li><p>Weeks pass and I'm not quite satisfied and we start at 1 again</p></li></ol><p>I'm happy to say that we love the Punnett Square and it's for keeps, but have a look at the scrapped ideas as a little walk down memory lane:</p><p><img loading=\"lazy\" alt=\"logo graveyard\" src=\"/PopGen.jl/assets/images/logo_graveyard-5898e03f0758817ece4b6cefede9b2e1.png\" width=\"909\" height=\"3016\"></p>",
            "url": "https://BioJulia.net/PopGen.jl/blog/logos",
            "title": "Logo Graveyard",
            "summary": "What is that logo?",
            "date_modified": "2020-06-03T00:00:00.000Z",
            "author": {
                "name": "Pavel Dimens",
                "url": "https://github.com/pdimens"
            },
            "tags": [
                "misc"
            ]
        }
    ]
}