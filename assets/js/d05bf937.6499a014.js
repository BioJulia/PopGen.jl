"use strict";(self.webpackChunkpop_gen_jl=self.webpackChunkpop_gen_jl||[]).push([[700],{3905:function(e,t,n){n.d(t,{Zo:function(){return m},kt:function(){return c}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var r=a.createContext({}),u=function(e){var t=a.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=u(e.components);return a.createElement(r.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,s=e.originalType,r=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),d=u(n),c=i,p=d["".concat(r,".").concat(c)]||d[c]||f[c]||s;return n?a.createElement(p,l(l({ref:t},m),{},{components:n})):a.createElement(p,l({ref:t},m))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=n.length,l=new Array(s);l[0]=d;var o={};for(var r in t)hasOwnProperty.call(t,r)&&(o[r]=t[r]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var u=2;u<s;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8215:function(e,t,n){var a=n(7294);t.Z=function(e){var t=e.children,n=e.hidden,i=e.className;return a.createElement("div",{role:"tabpanel",hidden:n,className:i},t)}},6396:function(e,t,n){n.d(t,{Z:function(){return d}});var a=n(7462),i=n(7294),s=n(2389),l=n(9443);var o=function(){var e=(0,i.useContext)(l.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},r=n(9521),u=n(6010),m="tabItem_1uMI";function f(e){var t,n,a,s=e.lazy,l=e.block,f=e.defaultValue,d=e.values,c=e.groupId,p=e.className,h=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),_=null!=d?d:h.map((function(e){var t=e.props;return{value:t.value,label:t.label}})),g=(0,r.lx)(_,(function(e,t){return e.value===t.value}));if(g.length>0)throw new Error('Docusaurus error: Duplicate values "'+g.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var b=null===f?f:null!=(t=null!=f?f:null==(n=h.find((function(e){return e.props.default})))?void 0:n.props.value)?t:null==(a=h[0])?void 0:a.props.value;if(null!==b&&!_.some((function(e){return e.value===b})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+b+'" but none of its children has the corresponding value. Available values are: '+_.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var k=o(),v=k.tabGroupChoices,y=k.setTabGroupChoices,w=(0,i.useState)(b),N=w[0],j=w[1],T=[],L=(0,r.o5)().blockElementScrollPositionUntilNextRender;if(null!=c){var C=v[c];null!=C&&C!==N&&_.some((function(e){return e.value===C}))&&j(C)}var P=function(e){var t=e.currentTarget,n=T.indexOf(t),a=_[n].value;a!==N&&(L(t),j(a),null!=c&&y(c,a))},x=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a=T.indexOf(e.currentTarget)+1;n=T[a]||T[0];break;case"ArrowLeft":var i=T.indexOf(e.currentTarget)-1;n=T[i]||T[T.length-1]}null==(t=n)||t.focus()};return i.createElement("div",{className:"tabs-container"},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,u.Z)("tabs",{"tabs--block":l},p)},_.map((function(e){var t=e.value,n=e.label;return i.createElement("li",{role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,className:(0,u.Z)("tabs__item",m,{"tabs__item--active":N===t}),key:t,ref:function(e){return T.push(e)},onKeyDown:x,onFocus:P,onClick:P},null!=n?n:t)}))),s?(0,i.cloneElement)(h.filter((function(e){return e.props.value===N}))[0],{className:"margin-vert--md"}):i.createElement("div",{className:"margin-vert--md"},h.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==N})}))))}function d(e){var t=(0,s.Z)();return i.createElement(f,(0,a.Z)({key:String(t)},e))}},9443:function(e,t,n){var a=(0,n(7294).createContext)(void 0);t.Z=a},1312:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return u},contentTitle:function(){return m},metadata:function(){return f},assets:function(){return d},toc:function(){return c},default:function(){return h}});var a=n(7462),i=n(3366),s=(n(7294),n(3905)),l=n(6396),o=n(8215),r=["components"],u={slug:"relatedness",title:"Relatedness Tutorial",author:"Pavel Dimens",author_title:"Little this, little that",author_url:"https://github.com/pdimens",author_image_url:"https://avatars1.githubusercontent.com/u/19176506?s=460&u=3afad1d1ef3b09ddc4ab7108143f515be3412d5a&v=4",tags:["tutorials"]},m=void 0,f={permalink:"/PopGen.jl/blog/relatedness",editUrl:"https://github.com/BioJulia/PopGen.jl/edit/documentation/blog/2020-11-14-relatedness.md",source:"@site/blog/2020-11-14-relatedness.md",title:"Relatedness Tutorial",description:"Getting Started",date:"2020-11-14T00:00:00.000Z",formattedDate:"November 14, 2020",tags:[{label:"tutorials",permalink:"/PopGen.jl/blog/tags/tutorials"}],readingTime:13.26,truncated:!1,authors:[{name:"Pavel Dimens",title:"Little this, little that",url:"https://github.com/pdimens",imageURL:"https://avatars1.githubusercontent.com/u/19176506?s=460&u=3afad1d1ef3b09ddc4ab7108143f515be3412d5a&v=4"}],prevItem:{title:"A bit about FST",permalink:"/PopGen.jl/blog/fst"},nextItem:{title:"Logo Graveyard",permalink:"/PopGen.jl/blog/logos"}},d={authorsImageUrls:[void 0]},c=[{value:"Getting Started",id:"getting-started",children:[{value:"Estimators",id:"estimators",children:[],level:3}],level:2},{value:"The Steps",id:"the-steps",children:[{value:"1. Calculate pairwise relatedness",id:"1-calculate-pairwise-relatedness",children:[],level:3},{value:"2. Bootstrap to calculate CI",id:"2-bootstrap-to-calculate-ci",children:[],level:3},{value:"3. Create CI&#39;s for the sibships",id:"3-create-cis-for-the-sibships",children:[{value:"i. simulate known sibship pairs",id:"i-simulate-known-sibship-pairs",children:[],level:4},{value:"ii. get relatedness estimates for the simulated data",id:"ii-get-relatedness-estimates-for-the-simulated-data",children:[],level:4},{value:"iii. sibship intervals",id:"iii-sibship-intervals",children:[],level:4}],level:3},{value:"4. Finally, the data assessment",id:"4-finally-the-data-assessment",children:[],level:3},{value:"Closing remarks",id:"closing-remarks",children:[],level:3}],level:2}],p={toc:c};function h(e){var t=e.components,u=(0,i.Z)(e,r);return(0,s.kt)("wrapper",(0,a.Z)({},p,u,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h2",{id:"getting-started"},"Getting Started"),(0,s.kt)("p",null,"In a population genetics study, you often need to identify if there are kin in your data. This may be necessary because you are trying to remove kin from your data (because of Hardy-Weinberg assumptions), or maybe kinship is a central interest in your study. Either way, the goal of this tutorial is to provide you with a basic tutorial on using PopGen.jl to perform a relatedness analysis, which is sometimes called a ",(0,s.kt)("em",{parentName:"p"},"kinship")," analysis. To follow along, you'll need to have Julia, along with the packages PopGen.jl, PopGenSims.jl, and StatsBase.jl installed. We'll be using the ",(0,s.kt)("inlineCode",{parentName:"p"},"nancycats")," data because it's smaller than ",(0,s.kt)("inlineCode",{parentName:"p"},"gulfsharks"),", so things should be a lot quicker."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},"using PopGen, PopGenSims, StatsBase\n\njulia> cats = @nancycats\nPopData Object\n  Markers: Microsatellite\n  Ploidy: 2\n  Samples: 237\n  Loci: 9\n  Populations: 17\n  Coordinates: absent\n")),(0,s.kt)("h3",{id:"estimators"},"Estimators"),(0,s.kt)("p",null,"Like ",(0,s.kt)("inlineCode",{parentName:"p"},"Coancestry")," and the R packages that wrap it (i.e. ",(0,s.kt)("inlineCode",{parentName:"p"},"relate"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"related"),"), PopGen.jl provides a whole bunch of relatedness estimators that you can choose from for your data. Unfortunately, there is no right answer and you will need to use your discretion. Some people choose an estimator based on the heterozygosity of the data, others choose one based on more liberal or conservative values, and there are yet more criteria one can consider for choosing an estimator. To keep things simple, we're going to use ",(0,s.kt)("inlineCode",{parentName:"p"},"LynchLi"),". Why? Because I'm the one writing this tutorial, and I said so \ud83d\ude01. "),(0,s.kt)("h2",{id:"the-steps"},"The Steps"),(0,s.kt)("h3",{id:"1-calculate-pairwise-relatedness"},"1. Calculate pairwise relatedness"),(0,s.kt)("p",null,"This seems pretty obvious, but it needs to be said. In order to do the analysis, you need you get the pairwise relatedness values for the individuals of interest in your data. To keep things simple, we're going to do an all-by-all comparison. But, we also want to boostrap the pairs to create confidence intervals (\"CI\") for each pair, so let's talk about that."),(0,s.kt)("h3",{id:"2-bootstrap-to-calculate-ci"},"2. Bootstrap to calculate CI"),(0,s.kt)("p",null,"It would behoove us to bootstrap the loci in a pairwise comparison ",(0,s.kt)("em",{parentName:"p"},"n")," number of times so we can create a confidence interval for the relatedness estimates for each pair. This inflates the runtime of the analysis substantially, but it's a very useful method in making sense of our estimates. If one was to be conservative (and we generally are), then we would reject an estimate for a pair whose CI includes zero. In PopGen.jl, the estimates and bootstrapping are done all at once to minimize processing time, so the command for that would be"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},"julia> rel_out  = relatedness(cats, method = LynchLi, iterations = 1000)\n")),(0,s.kt)("p",null,"By default, the ",(0,s.kt)("inlineCode",{parentName:"p"},"relatedness")," function uses a 95% CI (",(0,s.kt)("inlineCode",{parentName:"p"},"interval = (0.025, 0.975)"),"), but you can change that with ",(0,s.kt)("inlineCode",{parentName:"p"},"interval = (low,high)")," where ",(0,s.kt)("inlineCode",{parentName:"p"},"low")," and ",(0,s.kt)("inlineCode",{parentName:"p"},"high")," are decimals of your quantiles.\nThe ",(0,s.kt)("inlineCode",{parentName:"p"},"relatedness()")," function returns a ",(0,s.kt)("inlineCode",{parentName:"p"},"NamedTuple")," of dataframes whenever you are bootstrapping, where each element shares its name with the method used, so in this case, we can access our results with ",(0,s.kt)("inlineCode",{parentName:"p"},"rel_out.LynchLi"),"."),(0,s.kt)(l.Z,{block:!0,defaultValue:"rel",values:[{label:"relatedness",value:"rel"},{label:"plotting",value:"pl"}],mdxType:"Tabs"},(0,s.kt)(o.Z,{value:"rel",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"julia> rel_out.LynchLi\n27966\xd78 DataFrame\n   Row \u2502 sample_1  sample_2  n_loci  LynchLi     LynchLi_mean  LynchLi_median  LynchLi_S \u22ef\n       \u2502 String    String    Int64   Float64?    Float64?      Float64?        Float64?  \u22ef\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n     1 \u2502 N215      N216           8   0.743535      0.747288        0.748042     0.75344 \u22ef\n     2 \u2502 N215      N217           8   0.230605      0.233593        0.240085     0.34187\n     3 \u2502 N215      N218           8   0.230605      0.230507        0.221861     0.32161\n     4 \u2502 N215      N219           8   0.230605      0.23601         0.23567      0.32782\n     5 \u2502 N215      N220           8   0.333191      0.33798         0.350492     0.39898 \u22ef\n     6 \u2502 N215      N221           8   0.589656      0.594223        0.601308     0.61945\n     7 \u2502 N215      N222           8   0.0254328     0.0347216       0.0262021    0.21408\n     8 \u2502 N215      N223           8   0.333191      0.329983        0.331411     0.38402\n     9 \u2502 N215      N224           8  -0.0258602    -0.021062       -0.0301579    0.21112 \u22ef\n    10 \u2502 N215      N7             8  -0.282325     -0.27967        -0.288337     0.33611\n    11 \u2502 N215      N141           8  -0.0771532    -0.0796867      -0.083113     0.21261\n    12 \u2502 N215      N142           8   0.0254328     0.0302549       0.0330718    0.23957\n   \u22ee   \u2502    \u22ee         \u22ee        \u22ee         \u22ee            \u22ee              \u22ee             \u22ee     \u22f1\n 27955 \u2502 N295      N289           7   0.322731      0.347021        0.34118      0.41168 \u22ef\n 27956 \u2502 N295      N290           7   0.153414      0.160102        0.164866     0.22862\n 27957 \u2502 N296      N297           7  -0.0159038    -0.0182747      -0.0187108    0.16981\n 27958 \u2502 N296      N281           7   0.0405353     0.037025        0.0422647    0.15294\n 27959 \u2502 N296      N289           7   0.322731      0.328379        0.337317     0.35578 \u22ef\n 27960 \u2502 N296      N290           7   0.153414      0.152384        0.16194      0.19131\n 27961 \u2502 N297      N281           7  -0.0159038    -0.0128349      -0.0303449    0.21030\n 27962 \u2502 N297      N289           7   0.37917       0.392517        0.392818     0.45139\n 27963 \u2502 N297      N290           7   0.435609      0.437829        0.450044     0.47027 \u22ef\n 27964 \u2502 N281      N289           8   0.20428       0.21279         0.207425     0.29611\n 27965 \u2502 N281      N290           7   0.37917       0.386583        0.390585     0.45471\n 27966 \u2502 N289      N290           7   0.209853      0.217811        0.222894     0.28649\n                                                          2 columns and 27942 rows omitted\n"))),(0,s.kt)(o.Z,{value:"pl",mdxType:"TabItem"},(0,s.kt)("p",null,"And while it's totally optional, we can plot the distribution of values for some visual data exploration. For that we'll use Plots.jl and StatsPlots.jl. "),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"plotting packages")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"We could have used any plotting package, but Plots.jl was chosen for simplicity. Other great\noptions are (and not limited to): Makie.jl, Gadfly.jl, VegaLite.jl, and PlotlyJS.jl."))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},'using Plots, StatsPlots\n\njulia> density(rel_out.LynchLi.LynchLi)\njulia> title!("LynchLi relatedness")\n')),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"relatedness_histo",src:n(3030).Z})))),(0,s.kt)("h3",{id:"3-create-cis-for-the-sibships"},"3. Create CI's for the sibships"),(0,s.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,s.kt)("div",{parentName:"div",className:"admonition-heading"},(0,s.kt)("h5",{parentName:"div"},(0,s.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,s.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,s.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"There's more???")),(0,s.kt)("div",{parentName:"div",className:"admonition-content"},(0,s.kt)("p",{parentName:"div"},"The next set of steps seem like a lot more work, so allow me to explain. The estimators all generally give you some value between 0-1 (or 0-0.5, same idea) and you can intuit that certain values mean certain things, like that ",(0,s.kt)("inlineCode",{parentName:"p"},"0"),' is "unrelated", ',(0,s.kt)("inlineCode",{parentName:"p"},"0.25"),' is "half-sib", and ',(0,s.kt)("inlineCode",{parentName:"p"},"0.5"),' is "full-sib". However, those are fixed values, so how do we know how far we can deviate from 0.25 (for example) and still call our pair half-siblings? Instead of hand-waving, we can create confidence intervals from simulated data to act as sibship ranges for our data. If this doesn\'t make sense yet, it will below. Promise! '))),(0,s.kt)("h4",{id:"i-simulate-known-sibship-pairs"},"i. simulate known sibship pairs"),(0,s.kt)("p",null,'Next, we need to further contextualize what out estimates actually mean, and we need to devise a rigorous and defensible method to define the sibling-ship ("sibship") of a pair of samples as ',(0,s.kt)("strong",{parentName:"p"},"unrelated"),", ",(0,s.kt)("strong",{parentName:"p"},"half-sibs"),", or ",(0,s.kt)("strong",{parentName:"p"},"full-sibs"),". To do this, we're going to use PopGenSims.jl to simulate data based on the allele frequencies in our data. What ",(0,s.kt)("inlineCode",{parentName:"p"},"simulate_sibship")," does is simulate individuals based on the allele frequencies in your ",(0,s.kt)("inlineCode",{parentName:"p"},"PopData"),', then simulate offspring of a particular siblingship resulting from the "mating" of those individuals. For example, when you specify ',(0,s.kt)("inlineCode",{parentName:"p"},'"fullsib"'),", it generates two offspring resulting from two parents, ",(0,s.kt)("inlineCode",{parentName:"p"},"n")," number of times. We want to do this for each of the three kinds of sibships."),(0,s.kt)(l.Z,{block:!0,defaultValue:"un",values:[{label:"simulate unrelated",value:"un"},{label:"simulate halfsib",value:"h"},{label:"simulate fullsib",value:"f"}],mdxType:"Tabs"},(0,s.kt)(o.Z,{value:"un",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},'julia> unrelated_sims = simulate_sibship(cats, n = 500, relationship= "unrelated")\nPopData Object\n  Markers: Microsatellite\n  Ploidy: 2\n  Samples: 1000\n  Loci: 9\n  Populations: 1\n  Coordinates: absent\n'))),(0,s.kt)(o.Z,{value:"h",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},'julia> halfsib_sims = simulate_sibship(cats, n = 500, relationship= "halfsib")\nPopData Object\n  Markers: Microsatellite\n  Ploidy: 2\n  Samples: 1000\n  Loci: 9\n  Populations: 1\n  Coordinates: absent\n'))),(0,s.kt)(o.Z,{value:"f",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},'julia> fullsib_sims = simulate_sibship(cats, n = 500, relationship= "fullsib")\nPopData Object\n  Markers: Microsatellite\n  Ploidy: 2\n  Samples: 1000\n  Loci: 9\n  Populations: 1\n  Coordinates: absent\n')))),(0,s.kt)("p",null,"Technically, we could merge all three results into a single ",(0,s.kt)("inlineCode",{parentName:"p"},"PopData"),", but it will be easier to explain things if we don't. Feel free to take a peep into the simulated data:"),(0,s.kt)(l.Z,{block:!0,defaultValue:null,values:[{label:"meta",value:"meta"},{label:"loci",value:"loci"}],mdxType:"Tabs"},(0,s.kt)(o.Z,{value:"meta",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"julia> unrelated_sims.sampleinfo\n1000\xd75 DataFrame\n  Row \u2502 name            population  ploidy  longitude  latitude \n      \u2502 String          String      Int64   Float32?   Float32? \n\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1 \u2502 sim1_un_off1    unrelated        2   missing   missing  \n    2 \u2502 sim1_un_off2    unrelated        2   missing   missing  \n    3 \u2502 sim2_un_off1    unrelated        2   missing   missing  \n    4 \u2502 sim2_un_off2    unrelated        2   missing   missing  \n    5 \u2502 sim3_un_off1    unrelated        2   missing   missing  \n    6 \u2502 sim3_un_off2    unrelated        2   missing   missing  \n    7 \u2502 sim4_un_off1    unrelated        2   missing   missing  \n    8 \u2502 sim4_un_off2    unrelated        2   missing   missing  \n    9 \u2502 sim5_un_off1    unrelated        2   missing   missing  \n   10 \u2502 sim5_un_off2    unrelated        2   missing   missing  \n   11 \u2502 sim6_un_off1    unrelated        2   missing   missing  \n   12 \u2502 sim6_un_off2    unrelated        2   missing   missing  \n  \u22ee   \u2502       \u22ee             \u22ee         \u22ee         \u22ee         \u22ee\n  989 \u2502 sim495_un_off1  unrelated        2   missing   missing  \n  990 \u2502 sim495_un_off2  unrelated        2   missing   missing  \n  991 \u2502 sim496_un_off1  unrelated        2   missing   missing  \n  992 \u2502 sim496_un_off2  unrelated        2   missing   missing  \n  993 \u2502 sim497_un_off1  unrelated        2   missing   missing  \n  994 \u2502 sim497_un_off2  unrelated        2   missing   missing  \n  995 \u2502 sim498_un_off1  unrelated        2   missing   missing  \n  996 \u2502 sim498_un_off2  unrelated        2   missing   missing  \n  997 \u2502 sim499_un_off1  unrelated        2   missing   missing  \n  998 \u2502 sim499_un_off2  unrelated        2   missing   missing  \n  999 \u2502 sim500_un_off1  unrelated        2   missing   missing  \n 1000 \u2502 sim500_un_off2  unrelated        2   missing   missing  \n                                                976 rows omitted\n\n"))),(0,s.kt)(o.Z,{value:"loci",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre"},"julia> unrelated_sims.genodata\n9000\xd74 DataFrame\n  Row \u2502 name            population  locus   genotype   \n      \u2502 String          String      String  Tuple\u2026     \n\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n    1 \u2502 sim1_un_off1    unrelated   fca8    (135, 141)\n    2 \u2502 sim1_un_off1    unrelated   fca23   (132, 132)\n    3 \u2502 sim1_un_off1    unrelated   fca43   (143, 139)\n    4 \u2502 sim1_un_off1    unrelated   fca45   (126, 116)\n    5 \u2502 sim1_un_off1    unrelated   fca77   (154, 148)\n    6 \u2502 sim1_un_off1    unrelated   fca78   (150, 142)\n    7 \u2502 sim1_un_off1    unrelated   fca90   (199, 193)\n    8 \u2502 sim1_un_off1    unrelated   fca96   (109, 91)\n    9 \u2502 sim1_un_off1    unrelated   fca37   (208, 210)\n   10 \u2502 sim1_un_off2    unrelated   fca8    (139, 123)\n   11 \u2502 sim1_un_off2    unrelated   fca23   (140, 130)\n   12 \u2502 sim1_un_off2    unrelated   fca43   (139, 141)\n  \u22ee   \u2502       \u22ee             \u22ee         \u22ee         \u22ee\n 8989 \u2502 sim500_un_off1  unrelated   fca90   (199, 197)\n 8990 \u2502 sim500_un_off1  unrelated   fca96   (105, 113)\n 8991 \u2502 sim500_un_off1  unrelated   fca37   (208, 208)\n 8992 \u2502 sim500_un_off2  unrelated   fca8    (135, 137)\n 8993 \u2502 sim500_un_off2  unrelated   fca23   (136, 130)\n 8994 \u2502 sim500_un_off2  unrelated   fca43   (139, 145)\n 8995 \u2502 sim500_un_off2  unrelated   fca45   (120, 120)\n 8996 \u2502 sim500_un_off2  unrelated   fca77   (150, 156)\n 8997 \u2502 sim500_un_off2  unrelated   fca78   (142, 152)\n 8998 \u2502 sim500_un_off2  unrelated   fca90   (189, 191)\n 8999 \u2502 sim500_un_off2  unrelated   fca96   (113, 113)\n 9000 \u2502 sim500_un_off2  unrelated   fca37   (208, 182)\n                                      8976 rows omitted\n")))),(0,s.kt)("h4",{id:"ii-get-relatedness-estimates-for-the-simulated-data"},"ii. get relatedness estimates for the simulated data"),(0,s.kt)("p",null,"Next, we want to get the relatedness estimate for each simulated pair of \"known\" sibship. We are only interested in the values for the simulated pairs and not samples across pairs. If you aren't sure why that is, think of it this way: we're trying to create a range of values where we can confidently say unknown things are full-sibs (or half-sib, etc.), so we want to know what range of values we get from a bunch of known fullsib pairs, not the unknown relationships of samples between pairs. "),(0,s.kt)("p",null,"It would a nightmare to manually specify only 2 individuals at a time into ",(0,s.kt)("inlineCode",{parentName:"p"},"relatedness()"),". Instead, the function has a shortcut built into it that will recognize the ",(0,s.kt)("inlineCode",{parentName:"p"},"population")," names generated from ",(0,s.kt)("inlineCode",{parentName:"p"},"simulate_sibship")," and only give you relatedness estimates for those pairs. So, we just need to run it once for each of our simulations, this time ",(0,s.kt)("em",{parentName:"p"},"without")," bootstrapping because we are only interested in the estimates. Make sure to use the same estimator! The run will be a lot faster this time because it only needs to calculate estimates for 500 pairs each time (our ",(0,s.kt)("inlineCode",{parentName:"p"},"n")," from above) and without bootstrapping. When not bootstrapping, ",(0,s.kt)("inlineCode",{parentName:"p"},"relatedness()")," returns a dataframe (versus a NamedTuple of dataframes)."),(0,s.kt)(l.Z,{block:!0,defaultValue:"un",values:[{label:"unrelated relatedness",value:"un"},{label:"halfsib relatedness",value:"h"},{label:"fullsib relatedness",value:"f"}],mdxType:"Tabs"},(0,s.kt)(o.Z,{value:"un",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},"julia> un_sims_rel = relatedness(unrelated_sims, method = LynchLi)\n500\xd74 DataFrame\n Row \u2502 sample_1        sample_2        n_loci  LynchLi    \n     \u2502 String          String          Int64   Float64?   \n\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   1 \u2502 sim100_un_off1  sim100_un_off2       9   0.0187624\n   2 \u2502 sim101_un_off1  sim101_un_off2       9  -0.204246\n   3 \u2502 sim102_un_off1  sim102_un_off2       9   0.0633641\n   4 \u2502 sim103_un_off1  sim103_un_off2       9   0.241771\n   5 \u2502 sim104_un_off1  sim104_un_off2       9  -0.338051\n   6 \u2502 sim105_un_off1  sim105_un_off2       9   0.0187624\n   7 \u2502 sim106_un_off1  sim106_un_off2       9  -0.29345\n   8 \u2502 sim107_un_off1  sim107_un_off2       9   0.0633641\n  \u22ee  \u2502       \u22ee               \u22ee           \u22ee         \u22ee\n 494 \u2502 sim94_un_off1   sim94_un_off2        9  -0.159644\n 495 \u2502 sim95_un_off1   sim95_un_off2        9  -0.0704411\n 496 \u2502 sim96_un_off1   sim96_un_off2        9   0.0633641\n 497 \u2502 sim97_un_off1   sim97_un_off2        9   0.241771\n 498 \u2502 sim98_un_off1   sim98_un_off2        9  -0.0704411\n 499 \u2502 sim99_un_off1   sim99_un_off2        9   0.241771\n 500 \u2502 sim9_un_off1    sim9_un_off2         9   0.197169\n                                          485 rows omitted\n"))),(0,s.kt)(o.Z,{value:"h",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},"julia> half_sims_rel = relatedness(halfsib_sims, method = LynchLi)\n500\xd74 DataFrame\n Row \u2502 sample_1        sample_2        n_loci  LynchLi    \n     \u2502 String          String          Int64   Float64?   \n\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   1 \u2502 sim100_hs_off1  sim100_hs_off2       9   0.111231\n   2 \u2502 sim101_hs_off1  sim101_hs_off2       9   0.111231\n   3 \u2502 sim102_hs_off1  sim102_hs_off2       9   0.333423\n   4 \u2502 sim103_hs_off1  sim103_hs_off2       9  -0.0220842\n   5 \u2502 sim104_hs_off1  sim104_hs_off2       9   0.111231\n   6 \u2502 sim105_hs_off1  sim105_hs_off2       9   0.244546\n   7 \u2502 sim106_hs_off1  sim106_hs_off2       9   0.244546\n   8 \u2502 sim107_hs_off1  sim107_hs_off2       9   0.377862\n  \u22ee  \u2502       \u22ee               \u22ee           \u22ee         \u22ee\n 494 \u2502 sim94_hs_off1   sim94_hs_off2        9   0.200108\n 495 \u2502 sim95_hs_off1   sim95_hs_off2        9   0.244546\n 496 \u2502 sim96_hs_off1   sim96_hs_off2        9   0.0223543\n 497 \u2502 sim97_hs_off1   sim97_hs_off2        9   0.200108\n 498 \u2502 sim98_hs_off1   sim98_hs_off2        9   0.111231\n 499 \u2502 sim99_hs_off1   sim99_hs_off2        9   0.333423\n 500 \u2502 sim9_hs_off1    sim9_hs_off2         9   0.288985\n                                          485 rows omitted\n"))),(0,s.kt)(o.Z,{value:"f",mdxType:"TabItem"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},"julia> full_sims_rel = relatedness(fullsib_sims, method = LynchLi)\n500\xd74 DataFrame\n Row \u2502 sample_1        sample_2        n_loci  LynchLi   \n     \u2502 String          String          Int64   Float64?  \n\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   1 \u2502 sim100_fs_off1  sim100_fs_off2       9  0.510483\n   2 \u2502 sim101_fs_off1  sim101_fs_off2       9  0.465982\n   3 \u2502 sim102_fs_off1  sim102_fs_off2       9  0.42148\n   4 \u2502 sim103_fs_off1  sim103_fs_off2       9  0.376979\n   5 \u2502 sim104_fs_off1  sim104_fs_off2       9  0.465982\n   6 \u2502 sim105_fs_off1  sim105_fs_off2       9  0.688489\n   7 \u2502 sim106_fs_off1  sim106_fs_off2       9  0.287976\n   8 \u2502 sim107_fs_off1  sim107_fs_off2       9  0.599486\n  \u22ee  \u2502       \u22ee               \u22ee           \u22ee         \u22ee\n 494 \u2502 sim94_fs_off1   sim94_fs_off2        9  0.688489\n 495 \u2502 sim95_fs_off1   sim95_fs_off2        9  0.821994\n 496 \u2502 sim96_fs_off1   sim96_fs_off2        9  0.554985\n 497 \u2502 sim97_fs_off1   sim97_fs_off2        9  0.599486\n 498 \u2502 sim98_fs_off1   sim98_fs_off2        9  0.554985\n 499 \u2502 sim99_fs_off1   sim99_fs_off2        9  0.510483\n 500 \u2502 sim9_fs_off1    sim9_fs_off2         9  0.376979\n                                         485 rows omitted\n")))),(0,s.kt)("p",null,"And if we wanted to plot out what that looks like (optional):"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},'using Plots, StatsPlots\n\njulia> density(rel_out.LynchLi.LynchLi, label = "real data", color = :grey, fill = (0, :grey))\njulia> density!(un_sims_rel.LynchLi, label = "unrelated")\njulia> density!(half_sims_rel.LynchLi, label = "halfsib", color = :blue)\njulia> density!(full_sims_rel.LynchLi, label = "fullsib", color = :black)\njulia> title!("relatedness estimates on simulated and real data")\n')),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"relatedness_histo",src:n(1501).Z})),(0,s.kt)("p",null,'Hopefully by now you are starting to contextualize why we\'re doing all of this. The distributions generated from our simulated data are giving us a better indication of what "unrelated", "halfsib", and "fullsib" estimates look like in our data.'),(0,s.kt)("h4",{id:"iii-sibship-intervals"},"iii. sibship intervals"),(0,s.kt)("p",null,"What we just did is create null distributions for each sibship relationship, so now all that's left is to get a confidence interval from each."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-julia"},"julia> unrelated_ci = quantile(un_sims_rel.LynchLi, (0.025, 0.975))\n(-0.3380513384854698, 0.33097433075726507)\n\njulia> halfsibs_ci = quantile(half_sims_rel.LynchLi, (0.025, 0.975))\n(-0.06652262584414452, 0.5556155725649398)\n\njulia> fullsibs_ci = quantile(full_sims_rel.LynchLi, (0.025, 0.975))\n(0.1989727186688347, 0.8219939374819633)\n")),(0,s.kt)("p",null,"So, given our data and the simulations we made, we can now make a reasonable assumption regarding the ranges for each sibship relationship:"),(0,s.kt)("table",null,(0,s.kt)("thead",{parentName:"table"},(0,s.kt)("tr",{parentName:"thead"},(0,s.kt)("th",{parentName:"tr",align:"left"},"Relationship"),(0,s.kt)("th",{parentName:"tr",align:"center"},"Lower Bound"),(0,s.kt)("th",{parentName:"tr",align:"center"},"Upper Bound"))),(0,s.kt)("tbody",{parentName:"table"},(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:"left"},"unrelated"),(0,s.kt)("td",{parentName:"tr",align:"center"},"-0.338"),(0,s.kt)("td",{parentName:"tr",align:"center"},"0.331")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:"left"},"half sibling"),(0,s.kt)("td",{parentName:"tr",align:"center"},"-0.066"),(0,s.kt)("td",{parentName:"tr",align:"center"},"0.555")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:"left"},"full sibling"),(0,s.kt)("td",{parentName:"tr",align:"center"},"0.199"),(0,s.kt)("td",{parentName:"tr",align:"center"},"0.82")))),(0,s.kt)("h3",{id:"4-finally-the-data-assessment"},"4. Finally, the data assessment"),(0,s.kt)("p",null,"Now that we have our relatedness estimates and the acceptable sibship ranges given our data, we can see where our data falls.\n",(0,s.kt)("em",{parentName:"p"},"Now"),", we can say that a particular sample pair is unrelated/halfsib/fullsib if:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},"that pair's confidence interval does not include zero and "),(0,s.kt)("li",{parentName:"ol"},"that pair's estimate falls within any of the three calculate ranges")),(0,s.kt)("p",null,"Unfortunately, the ranges overlap quite a bit, which makes interpretation difficult, so it may be suitable to use a different estimator. "),(0,s.kt)("h3",{id:"closing-remarks"},"Closing remarks"),(0,s.kt)("p",null,"There is more that can be done for relatedness, like network analysis. However, this tutorial covers what we consider a reasonable way to assess kinship in population genetic studies. If removing kin is your ultimate goal, consider the effects doing that may have on the analyses you are looking to do. Additionally, consider which individual of a pair you would remove and why. If you were curious as to how many identical loci a pair of samples may share, you can check that using ",(0,s.kt)("inlineCode",{parentName:"p"},"pairwiseidentical()"),". Good luck!"))}h.isMDXComponent=!0},3030:function(e,t,n){t.Z=n.p+"assets/images/nancycats_LynchLi-8b8fb132d841ad2cdff25f8b4d25c16d.png"},1501:function(e,t,n){t.Z=n.p+"assets/images/nancycats_sims-d891d2c0c1dcf2f3fb45784ca0664959.png"}}]);